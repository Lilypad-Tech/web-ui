"use strict";(()=>{var e={};e.id=339,e.ids=[339],e.modules={399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},2048:e=>{e.exports=require("fs")},5315:e=>{e.exports=require("path")},9254:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>g,patchFetch:()=>b,requestAsyncStorage:()=>w,routeModule:()=>h,serverHooks:()=>f,staticGenerationAsyncStorage:()=>v});var a={};t.r(a),t.d(a,{GET:()=>m});var s=t(4258),o=t(7865),n=t(7801),i=t(2048),u=t(5315),p=t.n(u);let l=process.env.DISCORD_TOKEN;async function d(e){try{let r=await fetch(`https://discord.com/api/v10/users/${e}`,{headers:{Authorization:`Bot ${l}`}});if(!r.ok){let t=await r.text();throw Error(`Failed to fetch Discord user with ID: ${e}. Status: ${r.status}. Body: ${t}`)}let t=await r.json();return{username:t?.global_name??t?.username,avatar:t.avatar?`https://cdn.discordapp.com/avatars/${t.id}/${t.avatar}.png`:null}}catch(r){return console.error(`Error fetching Discord user with ID ${e}:`,r),null}}async function c(e){try{let r=(await i.promises.readFile(e,"utf8")).trim().split("\n"),t=r[0].split(",");return r.slice(1).map(e=>{let r=e.split(",");return t.reduce((e,t,a)=>(e[t.trim()]=r[a]?r[a].trim():null,e),{})})}catch(e){throw console.error("Error reading or parsing CSV file:",e),e}}async function m(e){let r=p().join(process.cwd(),"public","ambassador_rewards.csv");if(!l)return console.error("Bot token not set in environment variables"),new Response("Server configuration error: Bot token not set",{status:500});try{let e=await c(r),t=await Promise.all(e.map(async e=>{if(!e.id)return console.warn(`Ambassador ${e.username} has no ID`),null;{let r=await d(e.id);return{id:e.id,username:r?.username??"Unknown",avatar:r?.avatar??null,wallet_address:e.wallet_address,rewards:null,contributions:null}}}));return new Response(JSON.stringify(t),{status:200,headers:{"Content-Type":"application/json"}})}catch(e){return console.error("Error processing ambassadors:",e),new Response(JSON.stringify({error:"Error processing ambassadors",details:e.message}),{status:500,headers:{"Content-Type":"application/json"}})}}let h=new s.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/ambassador/route",pathname:"/api/ambassador",filename:"route",bundlePath:"app/api/ambassador/route"},resolvedPagePath:"/Users/developersteve/Desktop/lilypad/web-ui/apps/rewards-dashboard/app/api/ambassador/route.js",nextConfigOutput:"export",userland:a}),{requestAsyncStorage:w,staticGenerationAsyncStorage:v,serverHooks:f}=h,g="/api/ambassador/route";function b(){return(0,n.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:v})}},4258:(e,r,t)=>{e.exports=t(517)}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[20],()=>t(9254));module.exports=a})();